function [o,g] = objngradatx(x,pars)

dim    = pars.dim;
X      = pars.X;
X_indx = pars.X_indx;
A_indx = pars.A_indx;
E      = pars.equality_cons;
L      = pars.lo_bounds;
U      = pars.up_bounds;
w      = pars.w;
%f      = pars.f;

x = reshape(x,dim,numel(x)/dim);
X(:,X_indx) = x;
X(:,A_indx) = X(:,A_indx);

o  = mexFindObjAnchored_omp_v2(X, X_indx, ...
                       E.X, E.A, ...
                       U.X, U.A, ...
                       L.X, L.A,w);
g_ = mexFindGradAnchored_v2(X, X_indx, ...
                       E.X, E.A, ...
                       U.X, U.A, ...
                       L.X, L.A,w); 

% o  = mexFindObjAnchored(X, X_indx, ...
%                        E.X, E.A, ...
%                        U.X, U.A, ...
%                        L.X, L.A,w);
% g_ = mexFindGradAnchored(X, X_indx, ...
%                        E.X, E.A, ...
%                        U.X, U.A, ...
%                        L.X, L.A,w);  
% o  = mexFindObjAnchored_omp(X, X_indx, ...
%                             E.X, E.A, ...
%                             U.X, U.A, ...
%                             L.X, L.A,w);
% g_ = mexFindGradAnchored_omp(X, X_indx, ...
%                             E.X, E.A, ...
%                             U.X, U.A, ...
%                             L.X, L.A,w);                     
g  = g_(:,X_indx);                   
g = g(:);