 REMARKS FILENAME="protein-eefx2.top"
 REMARKS    EEFx2 force field for simulated annealing with eefxPot implicit solvation.
 REMARKS    AUTHORS: Ye Tian, Charles Schwieters, Francesca Marassi (2016)

 SET ECHO OFF MESSAGE OFF END

 eval ($protein_top_vers="eef-2.0")


!---------------------------------------------------------------------
! Topology file for Xplor-NIH EEFx2 force field used with potential
! eefxPot for implicit solvation.
!	[Tian et al. (2014) J Magn Reson 243: 54]
!	[Tian et al. (2015) Biophys J  109: 574]
!	[Tian, Schwieters, Opella, Marassi September 2016]
!
! This topology file works in conjunction with the parameter
! file "protein-eefx2.par" and with the solvation parameter 
! set "EEFx parameters for CHARMM22" found in the Xplor-NIH 
! python module "eefxpotTools.py".
!
!	
! Parameters are taken primarily from CHARMM22.
! 	[Brooks et al. (2009) J Comput Chem 30: 1545]
! Some parameters are taken  from Xplor-NIH PARALLHDG (version 5.3).
!	[Linge et al. (2003) Proteins Proteins 50: 496]
! Retinal parameters are taken primarily from CHARMM36.
! 	[Brooks et al. (2009) J Comput Chem 30: 1545]
!	[Best et al. (2012) J Chem Theory Comput 8: 3257]
!	[MacKerell et al. (2004) J Am Chem Soc 126: 698]
!	[MacKerell et al. (1998) J Phys Chem B 102: 3586]
!
!
! Atom types, chemical groups, partial atomic charges, atomic
! masses, Van der Waals radii, bond lengths and bond angles
! are from CHARMM22.
!
! Improper dihedrals have CHARMM22 values but are defined
! as in Xplor-NIH PARALLHDG5.3. They are used to maintain
! trans-/cis-peptide bonds, tetrahedral center chirality, 
!  and planarity of peptide bonds and aromatic rings.
!
! Proper dihedrals treated with Xplor-NIH torsionDB statistical potential.
!
! Some Pro, His, Trp parameters (angle, bond, impr) are
! taken from PARALLHDG5.3.
!
! Partial atomic charges for ionic residues (Arg, Lys, Asp, Glu,
! and termini) are from CHARMM22 EEF.
! 	[Lazaridis (2003) Proteins 52:176]
!	[Lazaridis & Karplus (1999) Proteins 35:13]
!
! Energy force constants of bonds, angles, planarity, and
! chirality are adjusted for experimentally-restrained 
! simulated annealing calculations.
! Force constants were converted from CHARMM22 values:
!	1000 kcal mol-1 Ã…-2 for bonds
! 	 500 kcal mol-1 rad-2 for angles.
! 	 500 kcal mol-1 rad-2 for dihedrals.
!---------------------------------------------------------------------

set message off echo off end

autogenerate 
  angles=true
  dihedrals=false
end
 
! Masses
!-----------------------------------------------------------
 MASS H      1.0080 ! polar H 
 MASS HC     1.0080 ! N-ter H 
 MASS HA     1.0080 ! nonpolar H 
 MASS HT     1.0080 ! TIPS3P WATER HYDROGEN 
 MASS HP     1.0080 ! aromatic H 
 MASS HB     1.0080 ! backbone H 
 MASS HR1    1.0080 ! his he1, (+) his HG,HD2 
 MASS HR2    1.0080 ! (+) his HE1 
 MASS HR3    1.0080 ! neutral his HG, HD2 
 MASS HS     1.0080 ! thiol hydrogen

 MASS C     12.0110 ! carbonyl C, peptide backbone 
 MASS CA    12.0110 ! aromatic C 
 MASS CT1   12.0110 ! aliphatic sp3 C for CH 
 MASS CT2   12.0110 ! aliphatic sp3 C for CH2 
 MASS CT3   12.0110 ! aliphatic sp3 C for CH3 
 MASS CPH1  12.0110 ! his CG and CD2 carbons 
 MASS CPH2  12.0110 ! his CE1 carbon 
 MASS CPT   12.0110 ! trp C between rings 
 MASS CY    12.0110 ! TRP C in pyrrole ring 
 MASS CP1   12.0110 ! tetrahedral C (proline CA) 
 MASS CP2   12.0110 ! tetrahedral C (proline CB/CG) 
 MASS CP3   12.0110 ! tetrahedral C (proline CD) 
 MASS CC    12.0110 ! carbonyl C, asn,asp,gln,glu,cter,ct2 
 MASS CD    12.0110 ! carbonyl C, pres aspp,glup,ct1 
 MASS CPA   12.0110 ! heme alpha-C 
 MASS CPB   12.0110 ! heme beta-C 
 MASS CPM   12.0110 ! heme meso-C 
 MASS CM    12.0110 ! heme CO carbon 
 MASS CS    12.0110 ! thiolate carbon 
 MASS CCIS  12.0110 ! Cys

 MASS N     14.0070 ! proline N 
 MASS NR1   14.0070 ! neutral his protonated ring nitrogen 
 MASS NR2   14.0070 ! neutral his unprotonated ring nitrogen 
 MASS NR3   14.0070 ! charged his ring nitrogen 
 MASS NH1   14.0070 ! peptide nitrogen 
 MASS NH2   14.0070 ! amide nitrogen 
 MASS NH3   14.0070 ! ammonium nitrogen 
 MASS NC2   14.0070 ! guanidinium nitrogen 
 MASS NY    14.0070 ! TRP N in pyrrole ring 
 MASS NP    14.0070 ! Proline ring NH2+ (N-terminal) 
 MASS NPH   14.0070 ! heme pyrrole N 

 MASS O     15.9990 ! carbonyl oxygen 
 MASS OB    15.9990 ! carbonyl oxygen in acetic acid 
 MASS OC    15.9990 ! carboxylate oxygen 
 MASS OH1   15.9990 ! hydroxyl oxygen 
 MASS OS    15.9994 ! ester oxygen 
 MASS OT    15.9994 ! TIPS3P WATER OXYGEN 
 MASS OM    15.9990 ! heme CO/O2 oxygen 

 MASS S     32.0600 ! sulphur 
 MASS SM    32.0600 ! sulfur C-S-S-C type 
 MASS SS    32.0600 ! thiolate sulfur 

 MASS CAL   40.0800 ! calcium 2+ 
 MASS ZN    65.3700 ! zinc (II) cation 
 MASS FE    55.8470 ! heme iron 56 
 MASS CLA   34.0000 ! CHLORIDE Anion 
 MASS SOD   22.9898 ! Sodium Ion 


! Amino acid topology
!-----------------------------------------------------------

residue ALA
  group
    atom N   type=NH1     charge=-0.470 end !     | 
    atom HN  type=H       charge= 0.310 end !  HN-N 
    atom CA  type=CT1     charge= 0.070 end !     |     HB1 
    atom HA  type=HB      charge= 0.090 end !     |    / 
  group 				    !  HA-CA--CB-HB2 
    atom CB  type=CT3     charge=-0.270 end !     |    \ 
    atom HB1 type=HA      charge= 0.090 end !     |     HB3 
    atom HB2 type=HA      charge= 0.090 end !   O=C 
    atom HB3 type=HA      charge= 0.090 end !     | 
  group
    atom C   type=C       charge= 0.510 end
    atom O   type=O       charge=-0.510 end

  bond N  HN       
  bond N  CA    bond CA  HA   
  bond CA  CB   bond CB  HB1   bond CB  HB2     bond CB  HB3
  bond CA  C       
  bond C   O

  improper HA  N   C   CB  ! chirality CA
  improper HB1 HB2 CA HB3  ! methyl CB

!  dihedral HB1 CB  CA  C   ! methyl stagger UCL 12-MAR-00 

  DONO HN   N
  ACCE O    C
end
!-----------------------------------------------------------

residue ARG
  group
    atom N    type=NH1    charge=-0.470 end !     |                      HH11 
    atom HN   type=H      charge= 0.310 end !  HN-N                       | 
    atom CA   type=CT1    charge= 0.070 end !     |   HB1 HG1 HD1 HE     NH1-HH12 
    atom HA   type=HB     charge= 0.090 end !     |   |   |   |   |     / 
  group                                     !  HA-CA--CB--CG--CD--NE--CZ 
    atom CB   type=CT2    charge=-0.180 end !     |   |   |   |         \ 
    atom HB1  type=HA     charge= 0.090 end !     |   HB2 HG2 HD2        NH2-HH22 
    atom HB2  type=HA     charge= 0.090 end !   O=C                       | 
  group                                     !     |                      HH21 
    atom CG   type=CT2    charge=-0.180 end
    atom HG1  type=HA     charge= 0.090 end
    atom HG2  type=HA     charge= 0.090 end
  group
    atom CD   type=CT2    charge=-0.300 end
    atom HD1  type=HA     charge= 0.050 end
    atom HD2  type=HA     charge= 0.050 end
    atom NE   type=NC2    charge=-0.280 end
    atom HE   type=HC     charge= 0.120 end
    atom CZ   type=C      charge=-0.200 end
    atom NH1  type=NC2    charge=-0.121 end
    atom HH11 type=HC     charge= 0.2005 end
    atom HH12 type=HC     charge= 0.2005 end
    atom NH2  type=NC2    charge=-0.121 end
    atom HH21 type=HC     charge= 0.2005 end
    atom HH22 type=HC     charge= 0.2005 end
  group
    atom C     type=C     charge= 0.510 end
    atom O     type=O     charge=-0.510 end
 
  bond N  HN
  bond N  CA     bond CA  HA
  bond CA CB     bond CB  HB1     bond CB  HB2
  bond CB CG     bond CG  HG1     bond CG  HG2
  bond CG CD     bond CD  HD1     bond CD  HD2
  bond CD NE     bond NE  HE
  bond NE CZ
  bond CZ NH1    bond NH1 HH11    bond NH1 HH12
  bond CZ NH2    bond NH2 HH21    bond NH2 HH22
  bond CA C
  bond C  O

  improper HA  N   C    CB  !chirality CA
  improper NE  CD  CZ   HE  
  improper CZ  NE  NH1  NH2
  improper NH1 CZ  HH11 HH12
  improper NH2 CZ  HH21 HH22
  improper NE  CZ  NH1  HH11
  improper NE  CZ  NH2  HH21
  improper CZ  NH2 HE  NE  ! planar HE, CZ
  improper HB1 HB2 CA  CG  !stereo CB
  improper HG1 HG2 CB  CD  !stereo CG
  improper HD1 HD2 CG  NE  !stereo CD
  
!  dihedral CG  CB  CA  N
!  dihedral CD  CG  CB  CA
!  dihedral NE  CD  CG  CB
!  dihedral CZ  NE  CD  CG
  
  DONO HN   N
  DONO HE   NE
  DONO HH11 NH1
  DONO HH12 NH1
  DONO HH21 NH2
  DONO HH22 NH2
  ACCE O    C
end
!-----------------------------------------------------------

residue ASN
  group
    atom N    type=NH1    charge=-0.470 end !     | 
    atom HN   type=H      charge= 0.310 end !  HN-N 
    atom CA   type=CT1    charge= 0.070 end !     |   HB1 OD1    HD21 (cis to OD1) 
    atom HA   type=HB     charge= 0.090 end !     |   |   ||    / 
  group                                     !  HA-CA--CB--CG--ND2 
    atom CB   type=CT2    charge=-0.180 end !     |   |         \ 
    atom HB1  type=HA     charge= 0.090 end !     |   HB2        HD22 (trans to OD1) 
    atom HB2  type=HA     charge= 0.090 end !   O=C 
  group			                    !     | 
    atom CG   type=CC     charge= 0.550 end
    atom OD1  type=O      charge=-0.550 end
  group
    atom ND2  type=NH2    charge=-0.500 end
    atom HD21 type=H      charge= 0.250 end
    atom HD22 type=H      charge= 0.250 end
  group
    atom C    type=C      charge= 0.510 end
    atom O    type=O      charge=-0.510 end

  bond N  HN
  bond N  CA     bond CA  HA
  bond CA CB     bond CB  HB1     bond CB  HB2
  bond CB CG
  bond CG OD1
  bond CG ND2    bond ND2 HD21    bond ND2 HD22
  bond CA C
  bond C  O

  improper HA  N  C    CB  ! chirality CA
  improper CG  CB OD1  ND2
  improper ND2 CG HD21 HD22
  improper CB  CG ND2  HD21
  improper HB1 HB2 CA CG  ! stereo CB

!  dihedral CG  CB  CA  N
!  dihedral OD1 CG  CB  CA ! mult 2 ! UCL

  DONO HN   N
  DONO HD21 ND2
  DONO HD22 ND2
  ACCE OD1  CG
  ACCE O    C
end
!-----------------------------------------------------------

residue ASP
  group
    atom N   type=NH1   charge=-0.470 end !     | 
    atom HN  type=H     charge= 0.310 end !  HN-N 
    atom CA  type=CT1   charge= 0.070 end !     |   HB1   OD1 
    atom HA  type=HB    charge= 0.090 end !     |   |    // 
  group                                   !  HA-CA--CB--CG 
    atom CB  type=CT2   charge=-0.280 end !     |   |    \\ 
    atom HB1 type=HA    charge= 0.140 end !     |   HB2   OD2 
    atom HB2 type=HA    charge= 0.140 end !   O=C 
    atom CG  type=CC    charge= 1.000 end !     | 
    atom OD1 type=OC    charge=-0.500 end
    atom OD2 type=OC    charge=-0.500 end
  group
    atom C   type=C     charge= 0.510 end
    atom O   type=O     charge=-0.510 end

  bond N  HN
  bond N  CA     bond CA HA
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB CG
  bond CG OD1
  bond CG OD2
  bond CA C
  bond C  O

  improper HA N  C   CB   !chirality CA
  improper CG CB OD1 OD2
  improper HB1 HB2 CA CG  !stereo CB

!  dihedral CG  CB  CA  N
!  dihedral OD1 CG  CB  CA

  DONO HN   N
  ACCE OD1  CG
  ACCE OD2  CG
  ACCE O    C
end
!-----------------------------------------------------------

residue CYS
  group
    atom N   type=NH1    charge=-0.470 end !     | 
    atom HN  type=H      charge= 0.310 end !  HN-N 
    atom CA  type=CT1    charge= 0.070 end !     |   HB1 
    atom HA  type=HB     charge= 0.090 end !     |   | 
  group                                    !  HA-CA--CB--SG 
    atom CB  type=CT2    charge=-0.110 end !     |   |     \ 
    atom HB1 type=HA     charge= 0.090 end !     |   HB2    HG1 
    atom HB2 type=HA     charge= 0.090 end !   O=C 
    atom SG  type=S      charge=-0.230 end !     | 
    atom HG  type=HS     charge= 0.160 end
  group
    atom C   type=C      charge= 0.510 end
    atom O   type=O      charge=-0.510 end

  bond N  HN
  bond N  CA     bond CA HA
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB SG     bond SG HG 
  bond CA C
  bond C  O

  improper HA N C CB   !chirality CA
  improper HB1 HB2 CA SG  !stereo CB

!  dihedral SG  CB  CA  N

  DONO HN   N
  DONO HG  SG
  !!! ACCE SG    !REMOVED, ATB
  ACCE O    C
end
!-----------------------------------------------------------

residue GLN
  group
    atom N    type=NH1     charge=-0.470 end !     | 
    atom HN   type=H       charge= 0.310 end !  HN-N 
    atom CA   type=CT1     charge= 0.070 end !     |   HB1 HG1 OE1   HE21 (cis to OE1) 
    atom HA   type=HB      charge= 0.090 end !     |   |   |   ||    / 
  group	                                     !  HA-CA--CB--CG--CD--NE2 
    atom CB   type=CT2     charge=-0.180 end !     |   |   |         \ 
    atom HB1  type=HA      charge= 0.090 end !     |   HB2 HG2       HE22 (trans to OE1) 
    atom HB2  type=HA      charge= 0.090 end !   O=C 
  group	                                     !     | 
    atom CG   type=CT2     charge=-0.180 end
    atom HG1  type=HA      charge= 0.090 end
    atom HG2  type=HA      charge= 0.090 end
  group
    atom CD   type=CC      charge= 0.550 end
    atom OE1  type=O       charge=-0.550 end
  group
    atom NE2  type=NH2     charge=-0.500 end
    atom HE21 type=H       charge= 0.250 end
    atom HE22 type=H       charge= 0.250 end
  group
    atom C    type=C       charge= 0.510 end
    atom O    type=O       charge=-0.510 end

  bond N  HN
  bond N  CA     bond CA  HA
  bond CA CB     bond CB  HB1     bond CB  HB2
  bond CB CG     bond CG  HG1     bond CG  HG2
  bond CG CD
  bond CD OE1
  bond CD NE2    bond NE2 HE21    bond NE2 HE22
  bond CA C
  bond C  O

  improper HA  N  C    CB  !chirality CA
  improper CD  CG OE1  NE2
  improper NE2 CD HE21 HE22
  improper CG  CD NE2  HE21
  improper HB1 HB2 CA CG  !stereo CB
  improper HG1 HG2 CB CD  !stereo CG

!  dihedral CG  CB  CA  N
!  dihedral CD  CG  CB  CA
!  dihedral OE1 CD  CG  CB 

  DONO HN   N
  DONO HE21 NE2
  DONO HE22 NE2
  ACCE OE1  CD
  ACCE O    C
end
!-----------------------------------------------------------

residue GLU
  group
    atom N   type=NH1    charge=-0.470 end !     | 
    atom HN  type=H      charge= 0.310 end !  HN-N 
    atom CA  type=CT1    charge= 0.070 end !     |   HB1 HG1   OE1 
    atom HA  type=HB     charge= 0.090 end !     |   |   |    // 
  group                                    !  HA-CA--CB--CG--CD 
    atom CB  type=CT2    charge=-0.180 end !     |   |   |    \\ 
    atom HB1 type=HA     charge= 0.090 end !     |   HB2 HG2   OE2 
    atom HB2 type=HA     charge= 0.090 end !   O=C 
  group                                    !     | 
    atom CG  type=CT2    charge=-0.280 end
    atom HG1 type=HA     charge= 0.140 end
    atom HG2 type=HA     charge= 0.140 end
    atom CD  type=CC     charge= 1.000 end
    atom OE1 type=OC     charge=-0.500 end
    atom OE2 type=OC     charge=-0.500 end
  group
    atom C   type=C      charge= 0.510 end
    atom O   type=O      charge=-0.510 end

  bond N  HN
  bond N  CA     bond CA HA
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB CG     bond CG HG1     bond CG HG2
  bond CG CD
  bond CD OE1
  bond CD OE2
  bond CA C
  bond C  O

  improper HA N  C   CB    !chirality CA
  improper CD CG OE1 OE2
  improper HB1 HB2 CA CG  !stereo CB
  improper HG1 HG2 CB CD  !stereo CG

!  dihedral CG  CB  CA  N
!  dihedral CD  CG  CB  CA
!  dihedral OE1 CD  CG  CB ! mult 2 ! UCL

  DONO HN   N
  ACCE OE1  CD
  ACCE OE2  CD
  ACCE O    C
end
!-----------------------------------------------------------

residue GLY
  group
    atom N   type=NH1    charge=-0.470 end !     | 
    atom HN  type=H      charge= 0.310 end !     N-H 
    atom CA  type=CT2    charge=-0.020 end !     | 
    atom HA1 type=HB     charge= 0.090 end !     | 
    atom HA2 type=HB     charge= 0.090 end ! HA1-CA-HA2 
  group                                    !     | 
    atom C   type=C      charge= 0.510 end !     | 
    atom O   type=O      charge=-0.510 end !     C=O 

  bond N  HN
  bond N  CA     bond CA HA1     bond CA HA2
  bond CA C
  bond C  O

  DONO HN   N
  ACCE O    C

  improper HA1 HA2 N C  !stereo CA
end

!-----------------------------------------------------------
residue HSD  
 !!neutral His, proton on ND1.  !!YT
  group
    atom N   type=NH1     charge=-0.470 end !     |          HD1    HE1 
    atom HN  type=H       charge= 0.310 end !  HN-N           |     / 
    atom CA  type=CT1     charge= 0.070 end !     |   HB1    ND1--CE1 
    atom HA  type=HB      charge= 0.090 end !     |   |     /      | 
  group                                     !  HA-CA--CB--CG       | 
    atom ND1 type=NR1     charge=-0.360 end !     |   |     \      | 
    atom HD1 type=H       charge= 0.320 end !     |   HB2    CD2--NE2     
    atom CG  type=CPH1    charge=-0.050 end !   O=C           | 
    atom CB  type=CT2     charge=-0.090 end !     |          HD2 
    atom HB1 type=HA      charge= 0.090 end
    atom HB2 type=HA      charge= 0.090 end
  group                                    
    atom NE2 type=NR2     charge=-0.300 end
    atom CD2 type=CPH1    charge= 0.050 end
    atom HD2 type=HR3     charge= 0.050 end
    atom CE1 type=CPH2    charge= 0.150 end
    atom HE1 type=HR1     charge= 0.050 end
  group
    atom C   type=C       charge= 0.510 end
    atom O   type=O       charge=-0.510 end

  bond N   HN
  bond N   CA     bond CA  HA
  bond CA  CB     bond CB  HB1     bond CB  HB2
  bond CB  CG
  bond CG  ND1    
  bond ND1 HD1
  bond ND1 CE1    bond CE1 HE1
  bond CG  CD2    bond CD2 HD2
  bond CD2 NE2    
!!  bond NE2 HE2
  bond CE1 NE2
  bond CA  C
  bond C   O

  improper HA  N   C   CB  !chirality CA
  improper CG  CB  ND1 CD2
  improper ND1 CE1 CG  HD1
  improper CD2 NE2 CG  HD2
  improper CE1 ND1 NE2 HE1
  improper CG  ND1 CE1 NE2
  improper ND1 CE1 NE2 CD2
  improper CE1 NE2 CD2 CG
  improper NE2 CD2 CG  ND1
  improper CD2 CG  ND1 CE1
  improper HB1 HB2 CA CG  !stereo CB
!!  improper NE2 CD2 CE1 HE2     !YT  added 2014-10-10
!!  improper NE2 CE1 CD2 HE2     !YT

!  dihedral CG  CB  CA  N
!  dihedral ND1 CG  CB  CA
!  dihedral CD2 CG  CB  CA       !UCL added 09-MAR-00

  DONO HN   N
  DONO HD1  ND1
!!  DONO HE2  NE2
  ACCE O    C
  ACCE ND1 " "    
end
!-----------------------------------------------------------

residue HIS    
 !!neutral His, proton on NE2.  !!YT  
  group
    atom N   type=NH1     charge=-0.470 end !     |                 HE1 
    atom HN  type=H       charge= 0.310 end !  HN-N                 / 
    atom CA  type=CT1     charge= 0.070 end !     |   HB1    ND1--CE1 
    atom HA  type=HB      charge= 0.090 end !     |   |     /     || 
  group                                     !  HA-CA--CB--CG      || 
    atom NE2 type=NR1     charge=-0.300 end !     |   |    \\     || 
    atom HE2 TYPE=H       charge= 0.200 end !     |   HB2    CD2--NE2 
    atom CD2 type=CPH1    charge= 0.050 end !   O=C           |     \ 
    atom HD2 type=HR3     charge= 0.050 end !     |          HD2    HE2 
  group
    atom ND1 type=NR2     charge=-0.100 end 
    atom CG  type=CPH1    charge= 0.100 end
    atom CE1 type=CPH2    charge= 0.000 end
    atom HE1 type=HR1     charge= 0.000 end
  group
    atom CB  type=CT2     charge=-0.080 end
    atom HB1 type=HA      charge= 0.040 end
    atom HB2 type=HA      charge= 0.040 end
  group
    atom C   type=C       charge= 0.510 end
    atom O   type=O       charge=-0.510 end

  bond N   HN
  bond N   CA     bond CA  HA
  bond CA  CB     bond CB  HB1     bond CB  HB2
  bond CB  CG
  bond CG  ND1   ! bond ND1 HD1
  bond ND1 CE1    bond CE1 HE1
  bond CG  CD2    bond CD2 HD2
  bond CD2 NE2    bond NE2 HE2
  bond CE1 NE2
  bond CA  C
  bond C   O

  improper HA  N   C   CB  !chirality CA
  improper CG  CB  ND1 CD2
!  improper ND1 CE1 CG  HD1
  improper CD2 NE2 CG  HD2
  improper CE1 ND1 NE2 HE1
  improper CG  ND1 CE1 NE2
  improper ND1 CE1 NE2 CD2
  improper CE1 NE2 CD2 CG
  improper NE2 CD2 CG  ND1
  improper CD2 CG  ND1 CE1
  improper HB1 HB2 CA CG  ! stereo CB
  improper NE2 CD2 CE1 HE2     !YT  added 2014-10-10
  improper NE2 CE1 CD2 HE2     !YT

!  dihedral CG  CB  CA  N
!  dihedral ND1 CG  CB  CA
!  dihedral CD2 CG  CB  CA     !UCL added 09-MAR-00

  DONO HN   N
!  DONO HD1  ND1
  DONO HE2  NE2
  ACCE O    C
end
!-----------------------------------------------------------

residue HSP  
 !!protonated Histidine
  group
    atom N   type=NH1     charge=-0.470 end !     |         HD1    HE1 
    atom HN  type=H       charge= 0.310 end !  HN-N          |    /  
    atom CA  type=CT1     charge= 0.070 end !     |   HB1   ND1--CE1 
    atom HA  type=HB      charge= 0.090 end !     |   |     /     | 
  group                                     !  HA-CA--CB--CG      |
    atom ND1 type=NR3     charge=-0.550 end !     |   |     \     | 
    atom HD1 type=H       charge= 0.450 end !     |   HB2   CD2--NE2 
    atom NE2 type=NR3     charge=-0.550 end !   O=C          |	  \ 
    atom HE2 TYPE=H       charge= 0.450 end !     |         HD2    HE2 
    atom CE1 type=CPH2    charge= 0.100 end  
    atom HE1 type=HR2     charge= 0.000 end
  group
    atom CD2 type=CPH1    charge= 0.050 end
    atom HD2 type=HR1     charge= 0.000 end
    atom CG  type=CPH1    charge= 0.050 end
    atom CB  type=CT2     charge=-0.100 end
    atom HB1 type=HA      charge= 0.050 end
    atom HB2 type=HA      charge= 0.050 end
  group
    atom C   type=C       charge= 0.510 end
    atom O   type=O       charge=-0.510 end

  bond N   HN
  bond N   CA     bond CA  HA
  bond CA  CB     bond CB  HB1     bond CB  HB2
  bond CB  CG
  bond CG  ND1    bond ND1 HD1
  bond ND1 CE1    bond CE1 HE1
  bond CG  CD2    bond CD2 HD2
  bond CD2 NE2    
  bond NE2 HE2
  bond CE1 NE2
  bond CA  C
  bond C   O

  improper HA  N   C   CB  !chirality CA
  improper CG  CB  ND1 CD2
  improper ND1 CE1 CG  HD1
  improper CD2 NE2 CG  HD2
  improper CE1 ND1 NE2 HE1
  improper CG  ND1 CE1 NE2
  improper ND1 CE1 NE2 CD2
  improper CE1 NE2 CD2 CG
  improper NE2 CD2 CG  ND1
  improper CD2 CG  ND1 CE1
  improper HB1 HB2 CA CG    !stereo CB

!  dihedral CG  CB  CA  N
!  dihedral ND1 CG  CB  CA
!  dihedral CD2 CG  CB  CA  !UCL added 09-MAR-00

  DONO HN   N
  DONO HD1  ND1
  DONO HE2  NE2
  ACCE O    C
  ACCE NE2 " "    
end
!-----------------------------------------------------------

residue ILE
  group                                      ! 	         |   HG21  HG22 
    atom N    type=NH1     charge=-0.470 end !        HN-N      | / 
    atom HN   type=H       charge= 0.310 end !           |     CG2--HG23 
    atom CA   type=CT1     charge= 0.070 end !           |    / 
    atom HA   type=HB      charge= 0.090 end !        HA-CA--CB-HB    HD1 
  groupHC                                    !           |    \       / 
    atom CB   type=CT1     charge=-0.090 end !           |     CG1--CD--HD2 
    atom HB   type=HA      charge= 0.090 end !         O=C    / \     \ 
  group                                      !           |  HG11 HG12  HD3 
    atom CG2  type=CT3     charge=-0.270 end !
    atom HG21 type=HA      charge= 0.090 excl = (HG11 HG12 HD11 HD12 HD13) end
    atom HG22 type=HA      charge= 0.090 excl = (HG11 HG12 HD11 HD12 HD13) end
    atom HG23 type=HA      charge= 0.090 excl = (HG11 HG12 HD11 HD12 HD13) end
  group
    atom CG1  type=CT2     charge=-0.180 end
    atom HG11 type=HA      charge= 0.090 excl = (HG21 HG22 HG23 HD11 HD12 HD13) end
    atom HG12 type=HA      charge= 0.090 excl = (HG21 HG22 HG23 HD11 HD12 HD13) end
  group
    atom CD1  type=CT3     charge=-0.270 end
    atom HD11 type=HA      charge= 0.090 excl = (HG21 HG22 HG23 HG11 HG12) end
    atom HD12 type=HA      charge= 0.090 excl = (HG21 HG22 HG23 HG11 HG12) end
    atom HD13 type=HA      charge= 0.090 excl = (HG21 HG22 HG23 HG11 HG12) end
  group
    atom C    type=C       charge= 0.510 end
    atom O    type=O       charge=-0.510 end
  
  bond N   HN
  bond N   CA     bond CA  HA
  bond CA  CB     bond CB  HB
  bond CB  CG1    bond CG1 HG11    bond CG1 HG12
  bond CB  CG2    bond CG2 HG21    bond CG2 HG22    bond CG2 HG23
  bond CG1 CD1    bond CD1 HD11    bond CD1 HD12    bond CD1 HD13
  bond CA  C
  bond C   O

  improper HA N  C   CB   !chirality CA
  improper HB CA CG2 CG1  !chirality CB
  
  improper HG11 HG12 CB CD1  !stereo CG1
  improper HG21 HG22 CB HG23   !methyl CG2
  improper HD11 HD12 CG1 HD13  !methyl CD1

!  dihedral CG1 CB  CA  N
!  dihedral CD1 CG1 CB  CA
!  dihedral HD11 CD1 CG1 CB   ! UCL methyl stagger 12-MAR-00 
!  dihedral HG21 CG2 CB  CA   ! UCL methyl stagger 12-MAR-00 

  DONO HN   N
  ACCE O    C
end
!-----------------------------------------------------------

residue LEU
  group
    atom N    type=NH1    charge=-0.470 end !     |        HD11 HD12 
    atom HN   type=H      charge= 0.310 end !  HN-N          | / 
    atom CA   type=CT1    charge= 0.070 end !     |   HB1   CD1--HD13 
    atom HA   type=HB     charge= 0.090 end !     |   |    / 
  group	                                    !  HA-CA--CB--CG-HG 
    atom CB   type=CT2    charge=-0.180 end !     |   |    \ 
    atom HB1  type=HA     charge= 0.090 end !     |   HB2   CD2--HD23 
    atom HB2  type=HA     charge= 0.090 end !   O=C          | \ 
  group	                                    !     |        HD21 HD22 
    atom CG   type=CT1    charge=-0.090 end
    atom HG   type=HA     charge= 0.090 end
  group
    atom CD1  type=CT3    charge=-0.270 end
    atom HD11 type=HA     charge= 0.090 excl = (HD21 HD22 HD23 HG) end
    atom HD12 type=HA     charge= 0.090 excl = (HD21 HD22 HD23 HG) end
    atom HD13 type=HA     charge= 0.090 excl = (HD21 HD22 HD23 HG) end
  group
    atom CD2  type=CT3    charge=-0.270 end
    atom HD21 type=HA     charge= 0.090 excl = (HD11 HD12 HD13 HG) end
    atom HD22 type=HA     charge= 0.090 excl = (HD11 HD12 HD13 HG) end
    atom HD23 type=HA     charge= 0.090 excl = (HD11 HD12 HD13 HG) end
  group    
    atom C    type=C      charge= 0.510 end
    atom O    type=O      charge=-0.510 end

  bond N   HN
  bond N   CA     bond CA  HA
  bond CA  CB     bond CB  HB1     bond CB  HB2
  bond CB  CG     bond CG  HG
  bond CG  CD1    bond CD1 HD11    bond CD1 HD12    bond CD1 HD13
  bond CG  CD2    bond CD2 HD21    bond CD2 HD22    bond CD2 HD23
  bond CA  C
  bond C   O

  improper HA   N    C   CB    !chirality CA
  improper HG   CB   CD1 CD2   !stereo CG
  improper HB1  HB2  CA  CG       !stereo CB
  improper HD11 HD12 CG  HD13   !methyl CD1
  improper HD21 HD22 CG  HD23   !methyl CD2
    
!  dihedral CG  CB  CA  N
!  dihedral CD1 CG  CB  CA
!  dihedral HD11 CD1 CG  CB   ! UCL methyl stagger 12-MAR-00 
!  dihedral HD21 CD2 CG  CB   ! UCL methyl stagger 12-MAR-00 

  DONO HN   N
  ACCE O    C
end
!-----------------------------------------------------------

residue LYS
  group
    atom N   type=NH1    charge=-0.470 end !     | 
    atom HN  type=H      charge= 0.310 end !  HN-N 
    atom CA  type=CT1    charge= 0.070 end !     |   HB1 HG1 HD1 HE1    HZ1 
    atom HA  type=HB     charge= 0.090 end !     |   |   |   |   |     / 
  group                                    !  HA-CA--CB--CG--CD--CE--NZ--HZ2 
    atom CB  type=CT2    charge=-0.180 end !     |   |   |   |   |     \ 
    atom HB1 type=HA     charge= 0.090 end !     |   HB2 HG2 HD2 HE2    HZ3 
    atom HB2 type=HA     charge= 0.090 end !   O=C 
  group				           !     | 
    atom CG  type=CT2    charge=-0.180 end
    atom HG1 type=HA     charge= 0.090 end
    atom HG2 type=HA     charge= 0.090 end
  group
    atom CD  type=CT2    charge=-0.180 end
    atom HD1 type=HA     charge= 0.090 end
    atom HD2 type=HA     charge= 0.090 end
  group
    atom CE  type=CT2    charge= 0.000 end
    atom HE1 type=HA     charge= 0.000 end
    atom HE2 type=HA     charge= 0.000 end
    atom NZ  type=NH3    charge=-0.900 end
    atom HZ1 type=HC     charge= 0.300 end
    atom HZ2 type=HC     charge= 0.300 end
    atom HZ3 type=HC     charge= 0.300 end
  group
    atom C   type=C      charge= 0.510 end
    atom O   type=O      charge=-0.510 end

  bond N  HN
  bond N  CA     bond CA HA
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB CG     bond CG HG1     bond CG HG2
  bond CG CD     bond CD HD1     bond CD HD2
  bond CD CE     bond CE HE1     bond CE HE2
  bond CE NZ     bond NZ HZ1     bond NZ HZ2     bond NZ HZ3
  bond CA C
  bond C  O

  improper HA  N   C  CB      !chirality CA
  improper HB1 HB2 CA CG  !stereo CB
  improper HG1 HG2 CB CD  !stereo CG
  improper HD1 HD2 CG CE  !stereo CD
  improper HE1 HE2 CD NZ  !stereo CE
  improper HZ1 HZ2 CE HZ3 !methyl NZ

!  dihedral CG  CB  CA  N
!  dihedral CD  CG  CB  CA
!  dihedral CE  CD  CG  CB
!  dihedral NZ  CE  CD  CG
!  dihedral HZ1 NZ  CE  CD ! UCL stagger NH3 group 12-MAR-00

  DONO HN   N
  DONO HZ1  NZ
  DONO HZ2  NZ
  DONO HZ3  NZ
  ACCE O    C
end
!-----------------------------------------------------------

residue MET
  group
    atom N   type=NH1     charge=-0.470 end !     | 
    atom HN  type=H       charge= 0.310 end !  HN-N 
    atom CA  type=CT1     charge= 0.070 end !     |   HB1 HG1     HE1 
    atom HA  type=HB      charge= 0.090 end !     |   |   |       | 
  group                                     !  HA-CA--CB--CG--SD--CE--HE3 
    atom CB  type=CT2     charge=-0.180 end !     |   |   |       | 
    atom HB1 type=HA      charge= 0.090 end !     |   HB2 HG2     HE2 
    atom HB2 type=HA      charge= 0.090 end !   O=C 
  group                                     !     | 
    atom CG  type=CT2     charge=-0.140 end
    atom HG1 type=HA      charge= 0.090 end
    atom HG2 type=HA      charge= 0.090 end
    atom SD  type=S       charge=-0.090 end
    atom CE  type=CT3     charge=-0.220 end
    atom HE1 type=HA      charge= 0.090 end
    atom HE2 type=HA      charge= 0.090 end
    atom HE3 type=HA      charge= 0.090 end
  group
    atom C   type=C       charge= 0.510 end
    atom O   type=O       charge=-0.510 end

  bond N  HN
  bond N  CA     bond CA HA
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB CG     bond CG HG1     bond CG HG2
  bond CG SD
  bond SD CE     bond CE HE1     bond CE HE2     bond CE HE3
  bond CA C
  bond C  O

  improper HA  N   C  CB      !chirality CA
  improper HB1 HB2 CA CG  !stereo CB
  improper HG1 HG2 CB SD  !stereo CG
  improper HE1 HE2 SD HE3 !methyl CE

!  dihedral CG  CB  CA  N
!  dihedral SD  CG  CB  CA
!  dihedral CE  SD  CG  CB
!  dihedral HE1 CE  SD  CG ! UCL methyl stagger 12-MAR-00

  DONO HN   N
  ACCE O    C
end
!-----------------------------------------------------------

residue PHE
  group
    atom N   type=NH1     charge=-0.470 end !     |        HD1  HE1 
    atom HN  type=H       charge= 0.310 end !  HN-N         |    | 
    atom CA  type=CT1     charge= 0.070 end !     |   HB1  CD1--CE1 
    atom HA  type=HB      charge= 0.090 end !     |   |    //    \\ 
  group                                     !  HA-CA--CB--CG      CZ--HZ 
    atom CB  type=CT2     charge=-0.180 end !     |   |    \      / 
    atom HB1 type=HA      charge= 0.090 end !     |   HB2  CD2==CE2 
    atom HB2 type=HA      charge= 0.090 end !   O=C         |    | 
                                            !     |        HD2  HE2
  group  
    atom CG  type=CA      charge= 0.000 exclude=(CZ) end
  group
    atom CD1 type=CA      charge=-0.115 exclude=(CE2) end
    atom HD1 type=HP      charge= 0.115 end
  group
    atom CD2 type=CA      charge=-0.115 exclude=(CE1) end
    atom HD2 type=HP      charge= 0.115 end
  group
    atom CE1 type=CA      charge=-0.115 exclude=(CD2) end
    atom HE1 type=HP      charge= 0.115 end
  group
    atom CE2 type=CA      charge=-0.115 exclude=(CD1) end
    atom HE2 type=HP      charge= 0.115 end
  group
    atom CZ  type=CA      charge=-0.115 exclude=(CG) end
    atom HZ  type=HP      charge= 0.115 end
  group
    atom C   type=C       charge= 0.510 end
    atom O   type=O       charge=-0.510 end
  bond N   HN
  bond N   CA     bond CA  HA
  bond CA  CB     bond CB  HB1     bond CB  HB2
  bond CB  CG
  bond CG  CD1    bond CD1 HD1
  bond CG  CD2    bond CD2 HD2
  bond CD1 CE1    bond CE1 HE1
  bond CD2 CE2    bond CE2 HE2
  bond CE1 CZ     bond CZ  HZ
  bond CE2 CZ
  bond CA  C
  bond C   O

  improper HA  N   C   CB !chirality CA
  improper HB1 HB2 CA CG  !stereo CB

! Hs and CB around the ring
  improper HD2 CD2 CE2 CZ
  improper HE2 CE2 CZ  CE1
  improper HZ  CZ  CE1 CD1
  improper HE1 CE1 CD1 CG
  improper HD1 CD1 CG  CD2
  improper CB  CG  CD2 CE2

! around the ring
  improper CG  CD1 CE1 CZ 
  improper CD1 CE1 CZ  CE2
  improper CE1 CZ  CE2 CD2
  improper CZ  CE2 CD2 CG
  improper CE2 CD2 CG  CD1
  improper CD2 CG  CD1 CE1

!  dihedral CG  CB  CA  N
!  dihedral CD1 CG  CB  CA

  DONO HN   N
  ACCE O    C
end
!-----------------------------------------------------------

residue PRO
  group
    atom N   type=N     charge=-0.290 end !       HD1 HD2 
    atom CA  type=CP1   charge= 0.020 end !     |   \ / 
    atom HA  type=HB    charge= 0.090 end !     N---CD   HG1 
    atom CD  type=CP3   charge= 0.000 end !     |     \  / 
    atom HD1 type=HA    charge= 0.090 end !     |      CG 
    atom HD2 type=HA    charge= 0.090 end !     |     /  \ 
  group                                   !  HA-CA--CB   HG2 
    atom CB  type=CP2   charge=-0.180 end !     |   / \ 
    atom HB1 type=HA    charge= 0.090 end !     | HB1 HB2 
    atom HB2 type=HA    charge= 0.090 end !   O=C 
  group                                   !     | 
    atom CG  type=CP2   charge=-0.180 end
    atom HG1 type=HA    charge= 0.090 end
    atom HG2 type=HA    charge= 0.090 end
  group
    atom C   type=C     charge= 0.510 end   
    atom O   type=O     charge=-0.510 end

  bond N  CA     bond CA HA
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB CG     bond CG HG1     bond CG HG2
  bond CG CD     bond CD HD1     bond CD HD2
  bond CD N
  bond CA C
  bond C  O

  improper HA  N   C  CB      !chirality CA
  improper HB1 HB2 CA CG  !stereo CB
  improper HG1 HG2 CB CD  !stereo CG
  improper HD1 HD2 CG N   !stereo CD

  ACCE O    C
end
!-----------------------------------------------------------

residue SER
  group
    atom N   type=NH1    charge=-0.470 end !     | 
    atom HN  type=H      charge= 0.310 end !  HN-N 
    atom CA  type=CT1    charge= 0.070 end !     |   HB1 
    atom HA  type=HB     charge= 0.090 end !     |   | 
  group                                    !  HA-CA--CB--OG 
    atom CB  type=CT2    charge= 0.050 end !     |   |     \ 
    atom HB1 type=HA     charge= 0.100 end !     |   HB2    HG1 
    atom HB2 type=HA     charge= 0.100 end !   O=C 
    atom OG  type=OH1    charge=-0.550 end !     | 
    atom HG  type=H      charge= 0.300 end
  group
    atom C   type=C      charge= 0.510 end
    atom O   type=O      charge=-0.510 end

  bond N  HN
  bond N  CA     bond CA HA
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB OG     bond OG HG
  bond O  C
  bond C  CA

  improper HA  N   C  CB      !chirality CA
  improper HB1 HB2 CA OG  !stereo CB

!  dihedral OG  CB  CA  N

  DONO HN   N
  DONO HG   OG
  ACCE OG  " "
  ACCE O    C
end
!-----------------------------------------------------------

residue THR
  group
    atom N    type=NH1   charge=-0.470 end !     | 
    atom HN   type=H     charge= 0.310 end !  HN-N 
    atom CA   type=CT1   charge= 0.070 end !     |     OG1--HG1 
    atom HA   type=HB    charge= 0.090 end !     |    / 
  group	                                   !  HA-CA--CB-HB 
    atom CB   type=CT1   charge= 0.160 end !     |    \ 
    atom HB   type=HA    charge= 0.090 end !     |     CG2--HG21 
    atom OG1  type=OH1   charge=-0.550 end !   O=C    / \ 
    atom HG1  type=H     charge= 0.300 end !     | HG21 HG22 
  group
    atom CG2  type=CT3   charge=-0.270 end
    atom HG21 type=HA    charge= 0.090 end
    atom HG22 type=HA    charge= 0.090 end
    atom HG23 type=HA    charge= 0.090 end
  group
    atom C    type=C     charge= 0.510 end
    atom O    type=O     charge=-0.510 end

  bond N  HN
  bond N  CA     bond CA HA
  bond CA CB     bond CB HB
  bond CB OG1    bond OG1 HG1
  bond CB CG2    bond CG2 HG21    bond CG2 HG22    bond CG2 HG23
  bond CA C
  bond C  O

  improper HA N  C   CB        !chirality CA
  improper HB CA OG1 CG2       !stereo CB
  improper HG21 HG22 CB HG23   !methyl CG2

!  dihedral OG1 CB  CA  N
!  dihedral HG21 CG2 CB  CA   ! UCL methyl stagger 12-MAR-00 

  DONO HN   N
  DONO HG1  OG1
  ACCE OG1 " "
  ACCE O    C
end
!-----------------------------------------------------------

residue TRP
  group
    atom N   type=NH1   charge=-0.470 end !     |                  HE3 
    atom HN  type=H     charge= 0.310 end !  HN-N                   | 
    atom CA  type=CT1   charge= 0.070 end !     |   HB1            CE3 
    atom HA  type=HB    charge= 0.090 end !     |   |             /   \ 
  group                                   !  HA-CA--CB---CG-----CD2   CZ3-HZ3 
    atom CB  type=CT2   charge=-0.180 end !     |   |     |      |     | 
    atom HB1 type=HA    charge= 0.090 end !     |   HB2  CD1    CE2   CH2-HH2 
    atom HB2 type=HA    charge= 0.090 end !   O=C       /   \   / \   / 
  group                                   !     |     HD1    NE1   CZ2 
    atom CG  type=CY    charge=-0.030 end !                   |     | 
    atom CD1 type=CA    charge= 0.035 end !                  HE1   HZ2 
    atom HD1 type=HP    charge= 0.115 end
    atom NE1 type=NY    charge=-0.610 end
    atom HE1 type=H     charge= 0.380 end
    atom CE2 type=CPT   charge= 0.130 exclude=(CZ3) end
    atom CD2 type=CPT   charge=-0.020 exclude=(CH2) end
  group
    atom CE3 type=CA    charge=-0.115 exclude=(CZ2) end
    atom HE3 type=HP    charge= 0.115 end
  group
    atom CZ2 type=CA    charge=-0.115 exclude=(CE3) end
    atom HZ2 type=HP    charge= 0.115 end
  group
    atom CZ3 type=CA    charge=-0.115 exclude=(CE2) end
    atom HZ3 type=HP    charge= 0.115 end
  group
    atom CH2 type=CA    charge=-0.115 exclude=(CD2) end
    atom HH2 type=HP    charge= 0.115 end
  group
    atom C   type=C     charge= 0.510 end
    atom O   type=O     charge=-0.510 end

  bond N   HN
  bond N   CA     bond CA  HA
  bond CA  CB     bond CB  HB1     bond CB  HB2
  bond CB  CG
  bond CG  CD1    bond CD1 HD1
  bond CG  CD2
  bond CD1 NE1    bond NE1 HE1
  bond NE1 CE2
  bond CD2 CE2
  bond CD2 CE3    bond CE3 HE3
  bond CE2 CZ2    bond CZ2 HZ2
  bond CE3 CZ3    bond CZ3 HZ3
  bond CZ2 CH2    bond CH2 HH2
  bond CZ3 CH2
  bond CA  C
  bond C   O

! chirality
  improper HA  N   C   CB !chirality CA
  improper HB1 HB2 CA CG  !stereo CB

! around the 6-ring
  improper CD2 CE2 CZ2 CH2
  improper CE2 CZ2 CH2 CZ3
  improper CZ2 CH2 CZ3 CE3
  improper CH2 CZ3 CE3 CD2
  improper CZ3 CE3 CD2 CE2
  improper CE3 CD2 CE2 CZ2

! link 5-ring to 6-ring
  improper CD1 NE1 CE2 CZ2
  improper CD1 CG  CD2 CE3
  improper NE1 CE2 CZ2 CH2
  improper NE1 CE2 CD2 CE3
  improper CG  CD2 CE3 CZ3
  improper CG  CD2 CE2 CZ2

! 6-ring hydrogens
  improper HZ2 CZ2 CH2 CZ3
  improper HH2 CH2 CZ3 CE3
  improper HZ3 CZ3 CH2 CZ2
  improper HE3 CE3 CZ3 CH2

! 5-ring hydrogens and CB
  improper HE1 NE1 CE2 CD2
  improper HD1 CD1 NE1 CE2
  improper CB  CG  CD2 CE2

!  dihedral CG  CB  CA  N
!  dihedral CD1 CG  CB  CA

  DONO HN   N
  DONO HE1  NE1
  ACCE O    C
end
!-----------------------------------------------------------

residue TYR
  group
    atom N   type=NH1   charge=-0.470 end !     |        HD1  HE1 
    atom HN  type=H     charge= 0.310 end !  HN-N         |    | 
    atom CA  type=CT1   charge= 0.070 end !     |   HB1  CD1--CE1 
    atom HA  type=HB    charge= 0.090 end !     |   |    /      \ 
  group                                   !  HA-CA--CB--CG      CZ--OH 
    atom CB  type=CT2   charge=-0.180 end !     |   |    \      /     \ 
    atom HB1 type=HA    charge= 0.090 end !     |   HB2  CD2--CE2     HH 
    atom HB2 type=HA    charge= 0.090 end !   O=C         |    | 
  group                                   !     |        HD2  HE2 
    atom CG  type=CA    charge= 0.000 exclude=(CZ) end
  group
    atom CD1 type=CA    charge=-0.115 exclude=(CE2) end
    atom HD1 type=HP    charge= 0.115 end
  group
    atom CE1 type=CA    charge=-0.115 exclude=(CD2) end
    atom HE1 type=HP    charge= 0.115 end
  group
    atom CD2 type=CA    charge=-0.115 exclude=(CE1) end
    atom HD2 type=HP    charge= 0.115 end
  group
    atom CE2 type=CA    charge=-0.115 exclude=(CD1) end
    atom HE2 type=HP    charge= 0.115 end
  group
    atom CZ  type=CA    charge= 0.250 exclude=(CG) end
    atom OH  type=OH1   charge=-0.550 end
    atom HH  type=H     charge= 0.300 end
  group
    atom C   type=C     charge= 0.510 end
    atom O   type=O     charge=-0.510 end

  bond N   HN
  bond N   CA     bond CA  HA
  bond CA  CB     bond CB  HB1     bond CB  HB2
  bond CB  CG
  bond CG  CD1    bond CD1 HD1
  bond CG  CD2    bond CD2 HD2
  bond CD1 CE1    bond CE1 HE1
  bond CD2 CE2    bond CE2 HE2
  bond CE1 CZ
  bond CE2 CZ
  bond CZ  OH     bond OH  HH
  bond CA  C
  bond C   O

! chirality
  improper HA  N   C   CB !chirality CA
  improper HB1 HB2 CA CG  !stereo CB

! Hs, OH, and CB around the ring
  improper HD2 CD2 CE2 CZ
  improper HE2 CE2 CZ  CE1
  improper OH  CZ  CE1 CD1
  improper HE1 CE1 CD1 CG
  improper HD1 CD1 CG  CD2
  improper CB  CG  CD2 CE2

! around the ring
  improper CG  CD1 CE1 CZ 
  improper CD1 CE1 CZ  CE2
  improper CE1 CZ  CE2 CD2
  improper CZ  CE2 CD2 CG
  improper CE2 CD2 CG  CD1
  improper CD2 CG  CD1 CE1

!  dihedral CG  CB  CA  N
!  dihedral CD1 CG  CB  CA
!  dihedral CE2 CZ  OH  HH   ! UCL Added 12-MAR-00

  DONO HN   N
  DONO HH   OH
  ACCE OH  " "
  ACCE O    C
end
!-----------------------------------------------------------

residue VAL
  group
    atom N    type=NH1   charge=-0.470 end !     |    HG11 HG12 
    atom HN   type=H     charge= 0.310 end !  HN-N      | / 
    atom CA   type=CT1   charge= 0.070 end !     |     CG1--HG13 
    atom HA   type=HB    charge= 0.090 end !     |    / 
  group                                    !  HA-CA--CB-HB 
    atom CB   type=CT1   charge=-0.090 end !     |    \ 
    atom HB   type=HA    charge= 0.090 end !     |     CG2--HG21 
  group                                    !   O=C    / \ 
    atom CG1  type=CT3   charge=-0.270 end !     | HG21 HG22 
    atom HG11 type=HA    charge= 0.090 excl = (HG21 HG22 HG23) end
    atom HG12 type=HA    charge= 0.090 excl = (HG21 HG22 HG23) end
    atom HG13 type=HA    charge= 0.090 excl = (HG21 HG22 HG23) end
  group
    atom CG2  type=CT3   charge=-0.270 end
    atom HG21 type=HA    charge= 0.090 excl = (HG11 HG12 HG13) end
    atom HG22 type=HA    charge= 0.090 excl = (HG11 HG12 HG13) end
    atom HG23 type=HA    charge= 0.090 excl = (HG11 HG12 HG13) end
  group
    atom C    type=C     charge= 0.510 end
    atom O    type=O     charge=-0.510 end

  bond N   HN
  bond N   CA     bond CA  HA
  bond CA  CB     bond CB  HB
  bond CB  CG1    bond CG1 HG11    bond CG1 HG12    bond CG1 HG13
  bond CB  CG2    bond CG2 HG21    bond CG2 HG22    bond CG2 HG23
  bond CA  C
  bond C   O

  improper HA   N    C   CB         !chirality CA
  improper HB   CA   CG1 CG2 !stereo CB
  improper HG11 HG12 CB  HG13    !methyl G1
  improper HG21 HG22 CB  HG23    !methyl G2

!  dihedral CG1 CB  CA  N
!  dihedral HG11 CG1 CB  CA   ! UCL methyl stagger 12-MAR-00 
!  dihedral HG21 CG2 CB  CA   ! UCL methyl stagger 12-MAR-00 

  DONO HN   N
  ACCE O    C
end
!-----------------------------------------------------------

! RESIDUE CYSP (nitroxide spin label MTSL) 
! from: XPLOR-NIH protein.par
! CDS 2008/02/09
! originally by John Battiste (9-Aug-1999)

 MASS CS1   12.0110 ! thiolate carbon
 MASS CS2   12.0110 ! thiolate carbon
 MASS CSN1  12.0110 ! thiolate carbon
 MASS CSN2  12.0110 ! thiolate carbon
 MASS C3S6  12.0110 ! nitroxide radical methyl carbon CS6 
 MASS C3S7  12.0110 ! nitroxide radical methyl carbon CS7 
 MASS C3S8  12.0110 ! nitroxide radical methyl carbon CS8 
 MASS C3S9  12.0110 ! nitroxide radical methyl carbon CS9 
 MASS NO    14.0070 ! nitroxide radical nitroogen NS1
 MASS ON    15.9990 ! nitroxide radical oxygen OS1 

residue CYSP	

  group
    atom N    type=NH1   charge=-0.47   end      !  
    atom HN   type=H     charge= 0.31   end      !     |                                  
    atom CA   type=CT1   charge= 0.07   end      !  HN-N  
    atom HA   type=HB    charge= 0.09   end      !     |  HB1
  group                                          !     |   |
    atom CB   type=CT2   charge=-0.10   end      !  HA-CA--CB--SG1
    atom HB1  type=HA    charge= 0.09   end      !     |   |   |
    atom HB2  type=HA    charge= 0.09   end      !     |  HB2  |
    atom SG1  type=S     charge=-0.08   end      !   O=C       |
    atom SG2  type=S     charge=-0.08   end      !     |       |
    atom CL1  type=CT2   charge=-0.10   end      !            SG2
    atom HL11 type=HA    charge= 0.09   end      !       HL12  |
    atom HL12 type=HA    charge= 0.09   end      !           \ |
  group                                          !      HL11--CL1      HS4
    atom CS3  type=CS1   charge=-0.003  end      !             |        /
    atom CS4  type=CS2   charge=-0.340  end      !            CS3 === CS4
    atom HS4  type=HA    charge= 0.162  end      !             |       |
  group                                          !             |       |
    atom CS2  type=CSN1  charge= 0.334  end      !       CS8 - CS2    CS5 - CS7
    atom CS5  type=CSN2  charge= 0.329  end      !            /  \   /  \
    atom NS1  type=NO    charge= 0.220  end      !         CS9    NS1    CS6
    atom OS1  type=ON    charge=-0.438  end      !                 |  
  group                                          !                 OS1
    atom CS6  type=C3S6  charge=-0.335  end
    atom HS61 type=HA    charge= 0.09   end
    atom HS62 type=HA    charge= 0.09   end
    atom HS63 type=HA    charge= 0.09   end
  group
    atom CS8  type=C3S8  charge=-0.337  end
    atom HS81 type=HA    charge= 0.09   end
    atom HS82 type=HA    charge= 0.09   end
    atom HS83 type=HA    charge= 0.09   end
  group
    atom CS7  type=C3S7  charge=-0.335  end
    atom HS71 type=HA    charge= 0.09   end
    atom HS72 type=HA    charge= 0.09   end
    atom HS73 type=HA    charge= 0.09   end
  group
    atom CS9  type=C3S9  charge=-0.337  end
    atom HS91 type=HA    charge= 0.09   end
    atom HS92 type=HA    charge= 0.09   end
    atom HS93 type=HA    charge= 0.09   end
  group
    atom C    type=C     charge= 0.51   end
    atom O    type=O     charge=-0.51   end

  bond N   HN
  bond N   CA   bond CA HA
  bond CA  CB   bond CB HB1    bond CB HB2
  bond CB  SG1  bond SG1 SG2
  bond SG2 CL1  bond CL1 HL11  bond CL1 HL12
  bond CL1 CS3
  bond CS3 CS2
  bond CS2 CS8  bond CS8 HS81  bond CS8 HS82  bond CS8 HS83
  bond CS2 CS9  bond CS9 HS91  bond CS9 HS92  bond CS9 HS93
  bond CS2 NS1  bond NS1 OS1
  bond NS1 CS5
  bond CS5 CS6  bond CS6 HS61  bond CS6 HS62  bond CS6 HS63
  bond CS5 CS7  bond CS7 HS71  bond CS7 HS72  bond CS7 HS73
  bond CS5 CS4  bond CS4 HS4 
  bond CS4 CS3
  bond CA C
  bond C  O

  improper HA N C CB   !chirality CA
  improper HB1 HB2 CA SG1  !stereo CB
  improper HL11 HL12 CS3 SG2 !stereo CL1
  improper CS8 CS9 NS1 CS3 !stereo CS2
  improper CS6 CS7 NS1 CS4 !stereo CS5

  improper HS61 HS62 HS63 CS5 ! CS6 center
  improper HS71 HS72 HS73 CS5 ! CS7 center
  improper HS81 HS82 HS83 CS2 ! CS8 center
  improper HS91 HS92 HS93 CS2 ! CS9 center

  improper OS1 NS1 CS2 CS5
  improper HS4 CS4 CS5 CS3
  improper CL1 CS3 CS2 CS4

  improper NS1 CS2 CS3 CS4
  improper CS2 CS3 CS4 CS5
  improper CS3 CS4 CS5 NS1
  improper CS4 CS5 NS1 CS2
  improper CS5 NS1 CS2 CS3

! dihedral SG1  CB  CA  N

  DONO HN   N
!!  DONO HG  SG
  !!! ACCE SG    !REMOVED, ATB
  ACCE O    C
end
!-----------------------------------------------------------

! Residue LYR: modified Lysine with retinoic acid, protonated schiff base.
!   structure from:      [Hamanaka et al (1972) Acta Cryst B28: 214]
!   charges from:        [Hayashi & Ohmine (2000) J Phys Chem B 104: 10678]
!                        [Hayashi et al (2001) J Phys Chem B 105: 10124]
!   bonds/angles from:   [Nina et al. (1995) Biophys J 68: 25]
!                        [Baudry et al. (1997) J. Chem. Info. Comput. Sci. 37: 1018. 
!                        [Tajkhorshid et al (1997) J Phys. Chem B 101: 8021]
!                        [Tajkhorshid et al (1999) J Phys Chem B 103: 5581]
!                        [Tajkhorshid et al (2000) Biophys J 78: 683]

 MASS HPL    1.0080 ! polyene Schiff base
 MASS HPL1   1.0080 ! polyene Schiff base
 MASS HCR    1.0080 ! polyene Schiff base
 MASS CT    12.0110 ! tetrahedral
 MASS CR5   12.0110 ! Aliphatic carbon SP2
 MASS CR6   12.0110 ! Aliphatic carbon SP2
 MASS CR7   12.0110 ! Aliphatic carbon SP2
 MASS CR8   12.0110 ! Aliphatic carbon SP2
 MASS CR9   12.0110 ! Aliphatic carbon SP2
 MASS CR10  12.0110 ! Aliphatic carbon SP2
 MASS CR11  12.0110 ! Aliphatic carbon SP2
 MASS CR12  12.0110 ! Aliphatic carbon SP2
 MASS CR13  12.0110 ! Aliphatic carbon SP2
 MASS CR14  12.0110 ! Aliphatic carbon SP2
 MASS CR15  12.0110 ! Aliphatic carbon SP2
 MASS NCH1  14.0070 ! protonated nitrogen Schiff base

residue LYR  

  GROUP 
    ATOM N    type=NH1    charge=-0.470  end !                         
    ATOM HN   type=H      charge= 0.310  end !                      
    ATOM CA   type=CT1    charge= 0.070  end !                  O      HA     HN
    ATOM HA   type=HB     charge= 0.090  end !                   \\    |      /
  GROUP                                      !                  --C----CA----N---
    ATOM C    type=C      charge= 0.510  end !                         |
    ATOM O    type=O      charge=-0.510  end !                         |
  GROUP                                      !                         |
    ATOM CB   type=CT2    charge=-0.180  end !                         |
    ATOM HB1  type=HA     charge= 0.090  end !                     HB2-CB-HB1
    ATOM HB2  type=HA     charge= 0.090  end !                         |
  GROUP					   !                         |
    ATOM CG   type=CT2    charge=-0.180  end !                         |
    ATOM HG1  type=HA     charge= 0.090  end !                     HG2-CG-HG1
    ATOM HG2  type=HA     charge= 0.090  end !                         |
  GROUP					   !                         |
    ATOM CD   type=CT2    charge=-0.180  end !                         |
    ATOM HD1  type=HA     charge= 0.090  end !                     HD2-CD-HD1
    ATOM HD2  type=HA     charge= 0.090  end !                         |
  GROUP					   !                         |
    ATOM CE   type=CT2    charge= 0.340  end !                         |
    ATOM HE1  type=HA     charge= 0.050  end !                     HE2-CE-HE1
    ATOM HE2  type=HA     charge= 0.050  end !                         |
    ATOM N16  type=NCH1   charge=-0.727  end !                        +N16--H16 
    ATOM H16  type=HCR    charge= 0.505  end !                        //
    ATOM C15  type=CR15   charge= 0.362  end !                  H15--C15
    ATOM H15  type=HPL1   charge= 0.189  end !                        \
    ATOM C14  type=CR14   charge=-0.180  end !                H20B     C14-H14
    ATOM H14  type=HPL    charge= 0.180  end !                 |      //
    ATOM C13  type=CR13   charge= 0.131  end !           H20A--C20 -- C13
    ATOM C20  type=CT3    charge=-0.170  end !                 |      \
    ATOM H20A type=HA     charge= 0.090  end !                H20C     C12-H12
    ATOM H20B type=HA     charge= 0.090  end !                        //
    ATOM H20C type=HA     charge= 0.090  end !                   H11--C11
    ATOM C12  type=CR12   charge=-0.110  end !                        \
    ATOM H12  type=HPL    charge= 0.110  end !                H19B     C10-H10
    ATOM C11  type=CR11   charge=-0.090  end !                  |      //
    ATOM H11  type=HPL    charge= 0.090  end !            H19A--C19 -- C9
                                             !                  |      \
  GROUP                                      !                H19C      C8-H8
    ATOM C10  type=CR10   charge=-0.100  end !                         //
    ATOM H10  type= HPL   charge= 0.100  end !                     H7--C7
                                             !                         |
  GROUP                                      !                         |
    ATOM C9   type= CR9    charge= 0.00  end !                         |
    ATOM C19  type= CT3    charge=-0.27  end !                         |
    ATOM H19A type= HA     charge= 0.09  end !                         |
    ATOM H19B type= HA     charge= 0.09  end !                         |
    ATOM H19C type= HA     charge= 0.09  end !                         |
    					     !                         |
  GROUP  				     !                         |
    ATOM C8   type= CR8    charge=-0.10  end !                         | 
    ATOM H8   type= HPL    charge= 0.10  end !                         | 
    ATOM C7   type= CR7    charge=-0.10  end !                         | 
    ATOM H7   type= HPL    charge= 0.10  end !                         |
                                             !                         |    H17A  H17B
  GROUP                                      !             H18B        C6      \ /
    ATOM C6   type= CR6    charge= 0.00  end !                |      //   \    C17--H17C
                                             !          H18A--C18   //     \   /     
  GROUP                                      !                |  \ //       \ /       
    ATOM C5   type= CR5    charge= 0.00  end !             H18C   C5         C1 -- C16--H16B
    ATOM C18  type= CT3    charge=-0.27  end !                    |          |     / \
    ATOM H18A type= HA     charge= 0.09  end !                    |          |  H16C  H16A
    ATOM H18B type= HA     charge= 0.09  end !                    |          |
    ATOM H18C type= HA     charge= 0.09  end !               H4A--C4         C2--H2A
                                             !                   / \        / \
  GROUP                                      !                 H4B  \      /   H2B
    ATOM C4   type= CT2    charge=-0.20  end !                       \    /
    ATOM H4A  type= HA     charge= 0.10  end !                         C3
    ATOM H4B  type= HA     charge= 0.10  end !                        /  \
					   !                       H3A    H3B
  GROUP
    ATOM C3   type= CT2    charge=-0.20  end !
    ATOM H3A  type= HA     charge= 0.10  end !
    ATOM H3B  type= HA     charge= 0.10  end !
  
  GROUP
    ATOM C2   type= CT2    charge=-0.20  end !
    ATOM H2A  type= HA     charge= 0.10  end !
    ATOM H2B  type= HA     charge= 0.10  end !
  
  GROUP
    ATOM C1   type= CT     charge= 0.00  end !
    ATOM C16  type= CT3    charge=-0.27  end !
    ATOM H16A type= HA     charge= 0.09  end !
    ATOM H16B type= HA     charge= 0.09  end !
    ATOM H16C type= HA     charge= 0.09  end !
  
  GROUP
    ATOM C17  type= CT3    charge=-0.27  end !
    ATOM H17A type= HA     charge= 0.09  end !
    ATOM H17B type= HA     charge= 0.09  end !
    ATOM H17C type= HA     charge= 0.09  end !

  BOND N   HN    
  BOND N   CA     BOND CA  HA  
  BOND CA  C      BOND C   O
  BOND CA  CB     BOND CB  HB1    BOND CB  HB2
  BOND CB  CG     BOND CG  HG1    BOND CG  HG2
  BOND CG  CD     BOND CD  HD1    BOND CD  HD2
  BOND CD  CE     BOND CE  HE1    BOND CE  HE2
  BOND CE  N16    BOND N16 H16
  BOND N16 C15    BOND C15 H15  
  BOND C15 C14    BOND C14 H14
  BOND C14 C13    BOND C13 C20    BOND C20 H20A  BOND C20 H20B   BOND C20 H20C
  BOND C13 C12    BOND C12 H12                                           
  BOND C12 C11    BOND C11 H11
  BOND C11 C10    BOND C10 H10
  BOND C10 C9     BOND C9  C19    BOND C19 H19A  BOND C19 H19B   BOND C19 H19C
  BOND C9  C8     BOND C8  H8
  BOND C8  C7     BOND C7  H7
  BOND C7  C6     BOND C6  C5
  BOND C5  C18    BOND C18 H18A   BOND C18 H18B  BOND C18 H18C
  BOND C5  C4     BOND C4  H4A    BOND C4  H4B
  BOND C4  C3     BOND C3  H3A    BOND C3  H3B
  BOND C3  C2     BOND C2  H2A    BOND C2  H2B
  BOND C2  C1     BOND C1  C6
  BOND C1  C16    BOND C16 H16A   BOND C16 H16B     BOND C16 H16C
  BOND C1  C17    BOND C17 H17A   BOND C17 H17B     BOND C17 H17C

! LYS moiety geometry
  IMPRoper HA   N    C    CB     ! TYPE:  HB    NH1   C     CT2  ( 66.1640) chirality CA 
  IMPRoper HB1  HB2  CA   CG     ! TYPE:  HA    HA    CT1   CT2  (-70.0781) stereo CB 
  IMPRoper HG1  HG2  CB   CD     ! TYPE:  HA    HA    CT2   CT2  (-70.7825) stereo CG 
  IMPRoper HD1  HD2  CG   CE     ! TYPE:  HA    HA    CT2   CT2  (-70.7825) stereo CD 
  IMPRoper HE1  HE2  CD   N16    ! TYPE:  HA    HA    CT2   NCH1 (-70.4126) stereo CE 

! Retinal chain double bond planarity
  IMPRoper N16  CE   C15  H16    !TYPE:  NCH1  CT2   CR15  HCR   (0.00)
  IMPRoper C15  N16  C14  H15    !TYPE:  CR15  NCH1  CR14  HPL1  (0.00)
  IMPRoper C14  C13  C15  H14    !TYPE:  CR14  CR13  CR15  HPL   (0.00)
  IMPRoper C13  C14  C12  C20    !TYPE:  CR13  CR14  CR12  CT3   (0.00)
  IMPRoper C12  C11  C13  H12    !TYPE:  CR12  CR11  CR13  HPL   (0.00)
  IMPRoper C11  C12  C10  H11    !TYPE:  CR11  CR12  CR10  HPL   (0.00)
  IMPRoper C10  C9   C11  H10    !TYPE:  CR10  CR9   CR11  HPL   (0.00)
  IMPRoper C9   C10  C8   C19    !TYPE:  CR9   CR10  CR8   CT3   (0.00)
  IMPRoper C8   C7   C9   H8     !TYPE:  CR8   CR7   CR9   HPL   (0.00)
  IMPRoper C7   C8   C6   H7     !TYPE:  CR7   CR8   CR6   HPL   (0.00)

! Retinal ring  planarity
  IMPRoper C6   C1   C5   C7   	!TYPE:  CR6   CT    CR5   CR7   (0.00) 
  IMPRoper C5   C6   C4   C18  	!TYPE:  CR5   CR6   CT2   CT3   (0.00) 
  IMPRoper C5   C6   C1   C2   	!TYPE:  CR5   CR6   CT    CT2   (0.00) 
  IMPRoper C7   H7   C5   C1   	!TYPE:  CR7   HPL   CR5   CT    (0.00) 

! LYS moiety dihedrals converted to impropers to allow use of torsionDB without DIHE
  IMPRoper N    CA   CB   CG  	!TYPE:  NH1   CT1   CT2   CT2   (chi1)				
  IMPRoper CA   CB   CG   CD 	!TYPE:  CT1   CT2   CT2   CT2   (chi2)
  IMPRoper CB   CG   CD   CE  	!TYPE:  CT2   CT2   CT2   CT2   (chi3)
  IMPRoper CG   CD   CE   N16 	!TYPE:  CT2   CT2   CT2   NCH1  (chi4)
  IMPRoper CD   CE   N16  C15 	!TYPE:  CT1   CT2   NCH1  CR15  (-90)

  DONO HN N
  DONO H16 N16
  ACCE O C
  
end
!-------------------------------------------

residue CHEX  !! ADDED BY MN
  group
    atom N    type=NH1   charge=-0.360 end
    atom HN   type=H     charge= 0.260 end
    atom CA   type=CT1   charge= 0.000 end
    atom HA   type=HA    charge= 0.100 end
    atom CB   type=CT2   charge=-0.200 end
    atom HB1  type=HA    charge= 0.100 end
    atom HB2  type=HA    charge= 0.100 end
    atom CG   type=CT1   charge=-0.200 end
    atom HG   type=HA    charge= 0.100 end
    atom CD1  type=CT2   charge=-0.200 end
    atom HD11 type=HA    charge= 0.100 end
    atom HD12 type=HA    charge= 0.100 end
    atom CD2  type=CT2   charge=-0.200 end
    atom HD21 type=HA    charge= 0.100 end
    atom HD22 type=HA    charge= 0.100 end
    atom CE1  type=CT2   charge=-0.200 end
    atom HE11 type=HA    charge= 0.100 end
    atom HE12 type=HA    charge= 0.100 end
    atom CE2  type=CT2   charge=-0.200 end
    atom HE21 type=HA    charge= 0.100 end
    atom HE22 type=HA    charge= 0.100 end
    atom CZ   type=CT2   charge=-0.200 end
    atom HZ1  type=HA    charge= 0.100 end
    atom HZ2  type=HA    charge= 0.100 end
    atom C    type=C     charge= 0.480 end
    atom O    type=O     charge=-0.480 end

  bond N  HN
  bond N  CA     bond CA HA
  bond CA CB     bond CB HB1     bond CB HB2
  bond CB CG     bond CG CD1     bond CG CD2     bond CG HG    
  bond CD1 CE1   bond CD1 HD11    bond CD1 HD12   
  bond CD2 CE2   bond CD2 HD21    bond CD2 HD22
  bond CE1 CZ    bond CE1 HE11    bond CE1 HE12
  bond CE2 CZ    bond CE2 HE21    bond CE2 HE22
  bond CZ HZ1    bond CZ  HZ2
  bond CA C
  bond C  O

  improper HA N C CB          !chirality CA
  improper HB1 HB2 CA CG  !stereo CB
  improper HG CB CD1 CD2      !stereo CG
  improper HD11 HD12 CG CE1      !stereo CD1
  improper HD21 HD22 CG CE2      !stereo CD2
  improper HE11 HE12 CE1 CZ      !stereo CE1
  improper HE11 HE22 CE2 CZ      !stereo CE2
  improper HZ1 HZ2 CE1 CE2  !stereo CZ

!  dihedral CG  CB  CA  N
!  dihedral CD1  CG  CB  CA

  DONO HN   N
  ACCE O    C
end
!-----------------------------------------------------------

residue ACE
  group
    atom CA  type=CT3 charge= 0.000 end
    atom HA1 type=HA  charge= 0.000 end
    atom HA2 type=HA  charge= 0.000 end
    atom HA3 type=HA  charge= 0.000 end
    atom C   type=C   charge= 0.500 end
    atom O   type=O   charge=-0.500 end

  bond C  CA     bond CA HA1     bond CA HA2     bond CA HA3
  bond C  O

  improper HA1 HA2 C HA3  !methyl CA

  ACCE O    C
end
!-----------------------------------------------------------

PRESidue NTER                      ! patch as "NTER - *" to any except PRO
  group
    modify    atom +N   type=NH3 charge=-0.900 end ! 
    delete    atom +HN                         end !         HT1 
    add       atom +HT1 type=HC  charge= 0.200 end !        / 
    add       atom +HT2 type=HC  charge= 0.200 end ! --CA--N--HT2 
    add       atom +HT3 type=HC  charge= 0.200 end !   |    \ 
    modify    atom +CA           charge= 0.200 end !   HA    HT3 
    modify    atom +HA           charge= 0.100 end

  add bond +HT1 +N
  add bond +HT2 +N
  add bond +HT3 +N

  add angle +HT1 +N +HT2
  add angle +HT2 +N +HT3
  add angle +HT2 +N +CA
  add angle +HT1 +N +HT3
  add angle +HT1 +N +CA
  add angle +HT3 +N +CA
  add improper +HT1 +HT2 +CA +HT3  !methyl N ???

!  add dihedral +C  +CA  +N  +HT1      ! UCL (12-MAR-00)

  ADD DONOr +HT1  +N
  ADD DONOr +HT2  +N
  ADD DONOr +HT3  +N
end
!-----------------------------------------------------------

 PRESIDUE GLYP ! Glycine N-terminus 
 
 GROUP   ! use in generate statement 
      MODI ATOM  +N     TYPE=NH3  CHARGE=    -.3000  END ! 
      ADD  ATOM  +HT1   TYPE=HC   CHARGE=     .3300  END !   HA1   HT1 
      ADD  ATOM  +HT2   TYPE=HC   CHARGE=     .3300  END !   |    / 
      ADD  ATOM  +HT3   TYPE=HC   CHARGE=     .3300  END ! --CA--N--HT2 
      MODI ATOM  +CA    TYPE=CT2  CHARGE=     .1300  END !   |    \ 
      MODI ATOM  +HA1   TYPE=HB   CHARGE=     .0900  END !   HA2   HT3 
      MODI ATOM  +HA2   TYPE=HB   CHARGE=     .0900  END ! 
      DELE ATOM  +HN       END  
 !END GROUP
 
 ADD  BOND  +HT1   +N      
 ADD  BOND  +HT2   +N      
 ADD  BOND  +HT3   +N      

 ADD  ANGLe +HT1  +N    +HT2
 ADD  ANGLe +HT1  +N    +HT3
 ADD  ANGLe +HT2  +N    +HT3
 ADD  ANGLe +HT1  +N    +CA
 ADD  ANGLe +HT2  +N    +CA
 ADD  ANGLe +HT3  +N    +CA

! ADD  DIHEdral +HT1  +N    +CA   +C
! ADD  DIHEdral +HT2  +N    +CA   +C
! ADD  DIHEdral +HT3  +N    +CA   +C
! ADD  DIHEdral +HT1  +N    +CA   +HA1
! ADD  DIHEdral +HT2  +N    +CA   +HA1
! ADD  DIHEdral +HT3  +N    +CA   +HA1
! ADD  DIHEdral +HT1  +N    +CA   +HA2
! ADD  DIHEdral +HT2  +N    +CA   +HA2
! ADD  DIHEdral +HT3  +N    +CA   +HA2

 ADD  DONOR  +HT1   +N      
 ADD  DONOR  +HT2   +N      
 ADD  DONOR  +HT3   +N      
 
 END {GLYP}
!-----------------------------------------------------------

PRESidue PROP                        ! N-terminal for PRO: "PROP - PRO"
! the charges are guessed from making the residue have charge +1
! and keeping the same charge on N as in NTER (Michael Nilges)

  modify    atom +N   type=NP  charge=-0.070 end
  add       atom +HT1 type=HC  charge= 0.240 end
  add       atom +HT2 type=HC  charge= 0.240 end
  modify    atom +CD           charge= 0.160 end
  modify    atom +CA           charge= 0.160 end
  modify    atom +HA           charge= 0.090 end
  modify    atom +HD1          charge= 0.090 end
  modify    atom +HD2          charge= 0.090 end


  add bond +HT1 +N
  add bond +HT2 +N

  add angle +HT1 +N +HT2
  add angle +HT2 +N +CA
  add angle +HT1 +N +CD
  add angle +HT1 +N +CA
  add angle +CD  +N +HT2
  add improper +HT1 +HT2 +CA +CD  !stereo N 
 
  ADD DONOr +HT1  +N
  ADD DONOr +HT2  +N
end
 
!-----------------------------------------------------------
PRESidue CTER               ! C-terminal for all amino acids "* - CTER"
! charge on -C changed from 0.700 to make group -1, Michael Nilges
  group
    modify    atom -CA            charge= 0.100  end !   OT2 
    modify    atom -C   type=CC   charge= 1.000  end !  // 
    delete    atom -O                            end ! -C 
    add       atom -OT1 type=OC   charge=-0.500  end !  \\ 
    add       atom -OT2 type=OC   charge=-0.500  end !   OT1 

  add bond -C -OT1
  add bond -C -OT2

  add angle -CA  -C -OT1
  add angle -CA  -C -OT2
  add angle -OT1 -C -OT2

  add improper -C -CA -OT2 -OT1
 
!  add dihedral -N -CA -C -OT1      ! UCL (12-MAR-00)

  ADD ACCEptor -OT1 -C
  ADD ACCEptor -OT2 -C
end
!-----------------------------------------------------------

PRESidue CTN                  ! C-terminal for all, CONH2 at end "* - CTN"
! charges not consistent with rest, Michael Nilges
  group
    modify    atom -C           charge= 0.48 end
    modify    atom -O           charge=-0.48 end
    add       atom -NT type=NH2 charge=-0.52 end
    add       atom -H1 type=H   charge= 0.26 end
    add       atom -H2 type=H   charge= 0.26 end

  add bond -C  -NT
  add bond -NT -H1
  add bond -NT -H2

  add angle -CA -C  -NT
  add angle -O  -C  -NT
  add angle -CA -C  -O
  add angle -C  -NT -H1
  add angle -C  -NT -H2
  add angle -H1 -NT -H2

  add improper -C  -CA -NT -O
  add improper -C  -NT -O  -H1
  add improper -NT -H1 -H2 -C

!  add dihedral -N -CA -C -NT      ! UCL (12-MAR-00)

  ADD DONOR  -H1 -NT
  ADD DONOR  -H2 -NT
end
!-----------------------------------------------------------

PRESidue PEPT     ! PEPTide bond link, for all except the  *(-) - (+)PRO link
                  ! "*(-) - PEPT - (+)*:
  add bond -C +N

  add angle -CA -C +N
  add angle -O  -C +N
  add angle -C  +N +CA
  add angle -C  +N +HN

  add improper  -C -CA +N -O                 ! planar -C
  add improper  +N -C +CA +HN                ! planar +N
  add improper -CA -C  +N  +CA               ! angle across peptide plane

! phi/psi related topology UCL 05-JUL-01

!  add dihedral  -C +N +CA +C  mult 6
!  add dihedral  -C +N +CA +CB mult 6
!  add dihedral  -CB -CA -C +N mult 6
!  add dihedral  -CB -CA -C -O mult 6         ! corrected from +O 16-Sept-02
end
!-----------------------------------------------------------

PRESidue PEPP     ! for  ...*(-) - (+)PRO  link, same as PEPT except
                  ! replacement H by CD and improper +N +CA +CD -C
  add bond -C +N

  add angle -CA -C +N
  add angle -O  -C +N
  add angle -C  +N +CA
  add angle -C  +N +CD

!  ADD DIHEdral  -C +N +CA +C  ! taken out since related to phi MN 18-MAR-02
!  ADD DIHEdral  -N -CA -C +N  ! taken out since equivalent below MN 18-MAR-02
!  ADD DIHEdral  -CA -C +N +CA ! taken out since improper below MN 18-MAR-02

  add improper  -C  -CA +N  -O               ! planar -C
  add improper  +N  -C +CA +CD               ! planar +N
  add improper -CA  -C  +N  +CA              ! angle across peptide plane

! psi related topology N.B. phi is fixed by ring bonding 05-JUL-01

!  add dihedral  -CB -CA -C +N mult 6
!  add dihedral  -CB -CA -C -O mult 6         ! corrected from +O 16-Sept-02
end
!-----------------------------------------------------------

PRESidue PPGP     ! for  GLY(-) - (+)PRO  link, same as PEPT except
                  ! replacement H by CD and improper +N +CA +CD -C
  add bond -C +N

  add angle -CA -C +N
  add angle -O  -C +N
  add angle -C  +N +CA
  add angle -C  +N +CD

!  ADD DIHEdral  -C +N +CA +C  ! taken out since related to phi MN 18-MAR-02
!  ADD DIHEdral  -N -CA -C +N  ! taken out since equivalent below MN 18-MAR-02
!  ADD DIHEdral  -CA -C +N +CA ! taken out since improper below MN 18-MAR-02

  add improper  -C  -CA +N  -O               ! planar -C
  add improper  +N  -C +CA +CD               ! planar +N
  add improper -CA  -C  +N  +CA              ! angle across peptide plane

end
!-----------------------------------------------------------

PRESidue PPGG { for GLY (-) - (+) GLY LINK }

  add bond -C +N

  add angle -CA -C +N
  add angle -O  -C +N
  add angle -C  +N +CA
  add angle -C  +N +HN

  add improper  -C -CA +N -O                 ! planar -C
  add improper  +N -C +CA +HN                ! planar +N
  add improper -CA -C  +N  +CA               ! angle across peptide plane

! phi/psi related topology UCL 05-JUL-01

!  add dihedral  -C +N +CA +C  mult 6
end
!-----------------------------------------------------------

PRESidue PPG1 { for ...*(-) - (+) GLY LINK }

  add bond -C +N

  add angle -CA -C +N
  add angle -O  -C +N
  add angle -C  +N +CA
  add angle -C  +N +HN

  add improper  -C -CA +N -O                 ! planar -C
  add improper  +N -C +CA +HN                ! planar +N
  add improper -CA -C  +N  +CA               ! angle across peptide plane

! phi/psi related topology UCL 05-JUL-01

!  add dihedral  -C +N +CA +C  mult 6
!  add dihedral  -CB -CA -C +N mult 6
!  add dihedral  -CB -CA -C -O mult 6          ! corrected from +O 16-Sept-02

end
!-----------------------------------------------------------

PRESidue PPG2 { for ... GLY(-) - (+) * LINK }
  add bond -C +N

  add angle -CA -C +N
  add angle -O  -C +N
  add angle -C  +N +CA
  add angle -C  +N +HN

  add improper  -C -CA +N -O                  ! planar -C
  add improper  +N -C +CA +HN                 ! planar +N
  add improper -CA -C  +N  +CA                ! angle across peptide plane

! phi/psi related topology UCL 05-JUL-01

!  add dihedral  -C +N +CA +C  mult 6
!  add dihedral  -C +N +CA +CB mult 6
end

!-----------------------------------------------------------

PRESidue DISU                ! disulfide bridge  ...CYS - DISU - CYS...
  group
    delete    atom 1HG               end
    modify    atom 1CB              charge= 0.300 end
    MODIfy    ATOM 1SG  TYPE=S      charge=-0.300 end
  group
    delete    atom 2HG               end
    modify    atom 2CB              charge= 0.300 end
    MODIfy    ATOM 2SG  TYPE=S      charge=-0.300 end

  add bond 1SG 2SG

  add angle 1CB 1SG 2SG
  add angle 1SG 2SG 2CB

!  add dihedral 1CB 1SG 2SG 2CB mult 6   ! UCL modified 12-MAR-00 & 07-JUL-01
end
!-----------------------------------------------------------

PRESidue DISN                ! disulfide bridge  ...CYS - DISU - CYS...
                             ! w/o the actual bond
  group
    delete    atom 1HG               end
    modify    atom 1CB              charge= 0.300 end
    MODIfy    ATOM 1SG  TYPE=S      charge=-0.300 end
  group
    delete    atom 2HG               end
    modify    atom 2CB              charge= 0.300 end
    MODIfy    ATOM 2SG  TYPE=S      charge=-0.300 end
end
!-----------------------------------------------------------

PRESidue LTOD                        ! change from L to D amino acid
  delete improper HA N C CB
  add    improper HA C N CB
end

PRESidue CISP                        ! change from trans to cis peptide bond
  modify atom C type=CCIS end
end

PRESidue CIPP                        ! change from trans to cis peptide bond. not necessary to have separate patch
  modify atom C type=CCIS end
end
!-----------------------------------------------------------

! linkage statement comment must begin with !LINK
! order is significant
!LINK PPGP HEAD - GLY TAIL + PRO END
!LINK PPGG HEAD - GLY TAIL + GLY END
!LINK PPG1 HEAD - *   TAIL + GLY END
!LINK PPG2 HEAD - GLY TAIL + *   END
!LINK PEPP HEAD - *   TAIL + PRO END
!LINK PEPT HEAD - *   TAIL + *   END



set message=$prev_messages echo=$prev_echo end
